<UserControl x:Class="EphemeralBrowser.App.Views.TabView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf">
    
    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisibility"/>
    </UserControl.Resources>
    
    <Grid>
        <!-- WebView2 Container -->
        <wv2:WebView2 x:Name="WebView" 
                     Visibility="{Binding IsLoaded, Converter={StaticResource BoolToVisibility}}"
                     NavigationStarting="WebView_NavigationStarting"
                     NavigationCompleted="WebView_NavigationCompleted"
                     CoreWebView2InitializationCompleted="WebView_CoreWebView2InitializationCompleted"/>
        
        <!-- Loading Indicator -->
        <Grid Background="White" 
              Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibility}}">
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                <ProgressBar IsIndeterminate="True" Width="300" Height="6" Margin="0,0,0,16"/>
                <TextBlock Text="Initializing secure container..." 
                          HorizontalAlignment="Center" 
                          FontSize="16"
                          Foreground="#FF666666"/>
                <TextBlock Text="{Binding LoadingUrl}" 
                          HorizontalAlignment="Center" 
                          FontSize="12"
                          Foreground="#FF999999"
                          Margin="0,8,0,0"/>
            </StackPanel>
        </Grid>
        
        <!-- Security Warning Overlay -->
        <Border Background="#FFF44336" 
                Visibility="{Binding HasSecurityWarning, Converter={StaticResource BoolToVisibility}}"
                VerticalAlignment="Top"
                Padding="12,6">
            <TextBlock Text="{Binding SecurityStatus}" 
                      Foreground="White" 
                      FontWeight="Bold"
                      HorizontalAlignment="Center"/>
        </Border>
    </Grid>
</UserControl>